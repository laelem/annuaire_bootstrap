<?php$sess_annuaire = $this->session->userdata('annuaire');$statuts_dispos = $this->config->item('statut');if(!empty($message)){	echo '<p class="message">'.$this->lang->line($message).'</p>';}// Filtresecho '<div class="filtres well">';	echo form_open('annuaire/filtre', array('id' => 'form_contact_filtre', 'name' => 'form_contact_filtre', 'class' => 'form-vertical'));		echo form_hidden('filtre_recherche_type', '');		echo form_hidden('filtre_recherche_del', '');		echo form_hidden('filtre_lettre_val', '');		echo form_hidden('filtre_lettre_del', '');			echo form_input(array('name' => 'filtre_recherche_val', 'maxlength' => '255', 'value' => ($sess_annuaire['filtre']['recherche_val']), 'class' => 'pull-left'));		echo '<div class="btn-group pull-left action">';			echo '<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">';				echo $this->lang->line('annuaire_libelle_filtre').' ';				echo '<span class="caret"></span>';			echo '</a>';			echo '<ul class="dropdown-menu">';				echo '<li><a href="#" id="filtre_recherche_nom">'.$this->lang->line('annuaire_libelle_filtre_nom').'</a></li>';				echo '<li><a href="#" id="filtre_recherche_prenom">'.$this->lang->line('annuaire_libelle_filtre_prenom').'</a></li>';			echo '</ul>';		echo '</div>';		echo '<button type="button" class="btn action pull-left" id="filtre_recherche_del" >'.$this->lang->line('general_effacer').'</button>';				echo '<div class="clear"></div>';				echo '<h6 class="pull-left">'.$this->lang->line('annuaire_libelle_filtre_lettre').'</h6>';		echo '<div class="btn-group pull-left action" data-toggle="buttons-radio">';			for ($i=ord("A") ; $i<=ord("Z") ; $i++){				if(!empty($sess_annuaire['filtre']['lettre_val']) && $sess_annuaire['filtre']['lettre_val'] == chr($i))					echo '<button class="btn filtre_lettre_val active" type="button">'.chr($i).'</button>';				else					echo '<button class="btn filtre_lettre_val" type="button">'.chr($i).'</button>';			}		echo '</div>';		echo '<button type="button" class="btn action pull-left" id="filtre_lettre_del" ><i class="icon-remove"></i></button>';		echo '<div class="clear"></div>';	echo '</form>';echo '</div>';// Bouton ajouterif($statuts_dispos[$this->session->userdata('statut')] == 'admin')	echo '<button type="button" class="btn btn-primary btn-large action_globale" onclick="window.location.href=\''.site_url('/annuaire/ajouter').'\'">'.$this->lang->line('general_ajouter').'</button>';if(!empty($liste_contact)){	echo '<table class="table table-bordered">';		echo '<thead>';			$tri = $sess_annuaire['tri']['champ'] == 'societe' ? ($sess_annuaire['tri']['type'] == 'asc' ? '<i class="icon-chevron-down"></i>' : '<i class="icon-chevron-up"></i>') : '';			echo '<th class="triable">'.$tri.' <a title="'.$this->lang->line('general_trier').'" href="'.site_url('/annuaire/tri/societe').'">'.$this->lang->line('annuaire_libelle_societe').'</a></th>';			$tri = $sess_annuaire['tri']['champ'] == 'nom' ? ($sess_annuaire['tri']['type'] == 'asc' ? '<i class="icon-chevron-down"></i>' : '<i class="icon-chevron-up"></i>') : '';			echo '<th class="triable">'.$tri.' <a title="'.$this->lang->line('general_trier').'" href="'.site_url('/annuaire/tri/nom').'">'.$this->lang->line('annuaire_libelle_nom').'</a></th>';			$tri = $sess_annuaire['tri']['champ'] == 'prenom' ? ($sess_annuaire['tri']['type'] == 'asc' ? '<i class="icon-chevron-down"></i>' : '<i class="icon-chevron-up"></i>') : '';			echo '<th class="triable">'.$tri.' <a title="'.$this->lang->line('general_trier').'" href="'.site_url('/annuaire/tri/prenom').'">'.$this->lang->line('annuaire_libelle_prenom').'</a></th>';			$tri = $sess_annuaire['tri']['champ'] == 'tel' ? ($sess_annuaire['tri']['type'] == 'asc' ? '<i class="icon-chevron-down"></i>' : '<i class="icon-chevron-up"></i>') : '';			echo '<th class="triable">'.$tri.' <a title="'.$this->lang->line('general_trier').'" href="'.site_url('/annuaire/tri/tel').'">'.$this->lang->line('annuaire_libelle_tel').'</a></th>';			echo '<th colspan="3"></th>';		echo '</thead>';		foreach($liste_contact as $contact){			echo '<tr>';							// Données				echo '<td>'.$contact['societe'].'</td>';				echo '<td>'.$contact['nom'].'</td>';				echo '<td>'.$contact['prenom'].'</td>';				echo '<td>'.$contact['tel'].'</td>';								// Actions				if($statuts_dispos[$this->session->userdata('statut')] == 'admin'){					echo '<td class="action"><a href="'.site_url('/annuaire/modifier/'.$contact['contact_id']).'" title="'.$this->lang->line('general_modifier').'"><i class="icon-pencil"></i></a></td>';					if($contact['actif'] == 1)						echo '<td class="action"><a href="'.site_url('/annuaire/desactiver/'.$contact['contact_id']).'" title="'.$this->lang->line('general_desactiver').'"><i class="icon-minus"></i></a></td>';					else						echo '<td class="action"><a href="'.site_url('/annuaire/activer/'.$contact['contact_id']).'" title="'.$this->lang->line('general_activer').'"><i class="icon-ok"></i></a></td>';					echo '<td class="action">';						echo '<a href="#modal_suppr_'.$contact['contact_id'].'" title="'.$this->lang->line('general_supprimer').'" data-toggle="modal"><i class="icon-remove"></i></a>';					echo '</td>';				}				else{					echo '<td class="action" colspan="3"><a href="'.site_url('/annuaire/visualiser/'.$contact['contact_id']).'" title="'.$this->lang->line('general_voir').'"><i class="icon-search"></i></a></td>';				}							echo '</tr>';		}	echo '</table>';		// Génération des fenêtres modales pour les suppressions	foreach($liste_contact as $contact){		$msg = sprintf($this->lang->line('annuaire_confirm_suppression'), $contact['prenom'].' '.$contact['nom']);		echo '<div class="modal" id="modal_suppr_'.$contact['contact_id'].'">';			echo '<div class="modal-header">';				echo '<h3>'.$this->lang->line('annuaire_modal_header').'</h3>';			echo '</div>';			echo '<div class="modal-body">';				echo '<p>'.$msg.'</p>';			echo '</div>';			echo '<div class="modal-footer">';				echo '<a class="btn" data-dismiss="modal">'.$this->lang->line('general_annuler').'</a>';				echo '<a href="'.site_url('/annuaire/supprimer/'.$contact['contact_id']).'" class="btn btn-primary">'.$this->lang->line('general_oui').'</a>';			echo '</div>';		echo '</div>';	}}echo $pagination;